paths:
  v2:
    getPivot:
      get:
        description: Retrieve a pivot by investigation id and pivot id.
        tags:
          - pivot
        summary: Retrieve a pivot by investigation id and pivot id.
        operationId: getPivotV2
        parameters:
          - in: path
            name: investigationId
            description: id of the investigation.
            required: true
            schema:
              type: string
          - in: path
            name: pivotId
            description: id of the pivot.
            required: true
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is pivot details
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetPivotDetailsResponse'
      put:
        description: Update a pivot by investigation id and pivot id with the supplied note.
        tags:
          - pivot
        summary: Update a pivot by investigation id and pivot id with the supplied note.
        operationId: updatePivot
        parameters:
          - in: path
            name: investigationId
            description: id of the investigation.
            required: true
            schema:
              type: string
          - in: path
            name: pivotId
            description: id of the pivot.
            required: true
            schema:
              type: string
          - in: query
            name: note
            description: New note for the pivot.
            required: true
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is new pivot details
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetPivotDetailsResponse'
  v1:
    testParser:
      post:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Test the parser UI with an array as input.
        tags:
          - testParser
        summary: Test a parser.
        operationId: testParserV2
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TestParserV2Request'
        responses:
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: The parser results are returned.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/TestParserDetailsWrapper'
    status:
      get:
        description: Retrieve meta information describing status field values (no parameters)
        tags:
          - investigationConfig
        summary: Retrieve status info
        operationId: getStatus
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, response status info
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetStatusResponse'

    referenceUrl:
      get:
        deprecated: true
        x-visibility: private
        description: Retrieve available reference url templates (no parameters)
        tags:
          - investigationConfig
        summary: Retrieve reference url templates
        operationId: getReferenceUrl
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, response available referenceUrl templates
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetGenericDictResponse'

    investigationConfig:
      get:
        description: Retrieve meta information describing investigation configuration (no parameters)
        tags:
          - investigationConfig
        summary: Retrieve investigation config
        operationId: getInvestigationConfig
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, returning investigation configuration information
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetInvestigationConfigResponse'
    investigation:
      post:
        description: Create an investigation (with parameters)
        tags:
          - investigation
        summary: Create an investigation
        operationId: createInvestigation
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateInvestigationRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, investigation was created and is returned
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetInvestigationDetailsResponse'

      get:
        description: Retrieve a list of investigations created or updated during a specified interval
        tags:
          - investigation
        summary: Retrieve a list of investigations by time
        operationId: getInvestigationList
        parameters:
          - in: query
            name: limit
            description: Upper limit on the size of value set returned (values not sorted before applying limit restriction)
            schema:
              type: integer
              default: 20
          - in: query
            name: create_time_gte
            description: Lower time bound on creation time for investigations (as epoch time value)
            schema:
              type: integer
              format: int64
          - in: query
            name: create_time_lte
            description: Upper time bound on creation time for investigations (as epoch time value)
            schema:
              type: integer
              format: int64
          - in: query
            name: update_time_gte
            description: Lower time bound on update time for investigations (as epoch time value)
            schema:
              type: integer
              format: int64
          - in: query
            name: update_time_lte
            description: Upper time bound on update time for investigations (as epoch time value)
            schema:
              type: integer
              format: int64
          - in: query
            name: offset
            description: Do not use (internal use only)
            schema:
              type: string
          - in: query
            name: search_order
            description: Search for results in ascending/descending order
            schema:
              type: string
              default: "asc"
          - in: query
            name: sort_order
            description: Return results in ascending/descending order
            schema:
              type: string
              default: "asc"
          - in: query
            name: type
            description: Restrict results to investigations with specified investigation type
            schema:
              type: string
              default: null
          - in: query
            name: status
            description: Restrict results to investigations with specified status
            schema:
              type: string
              default: null
          - in: query
            name: internal_status
            description: >
              Restrict results to investigations with specified internal status
              Values: 0 (New), 100 (Open), 200 (Closed)
            schema:
              type: string
              default: null
          - in: query
            name: assignee_id
            description: Restrict results to investigations with specified assignee
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, list of investigations returned
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetInvestigationListResponse'


    investigationId:
      get:
        description: Retrieve a single investigation by investigationId
        tags:
          - investigation
        summary: Retrieve a single investigation by investigationId
        operationId: getInvestigationById
        parameters:
          - in: path
            name: investigationId
            description: Investigation ID of the investigation to retrieve
            required: true
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, response investigation details
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetInvestigationDetailsResponse'
      patch:
        description: Request to update an investigation
        tags:
          - investigation
        summary: Update an investigation
        operationId: updateInvestigation
        parameters:
          - in: path
            name: investigationId
            description: Investigation ID of the investigation to update
            required: true
            schema:
              type: string
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateInvestigationRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Update success response with investigation details
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetInvestigationDetailsResponse'
    sourcetype:
      get:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Request to get single sourcetype by name
        tags:
          - testParser
        summary: gets single sourcetype by name
        operationId: getSourcetype
        parameters:
          - in: path
            name: sourcetype
            description: Name of the sourcetype you want information on
            required: true
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, response sourcetype information
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetGenericDictResponse'

    getPivot:
      get:
        description: Retrieve a pivot by investigation ID and pivot ID
        tags:
          - pivot
        summary: Retrieve a pivot by pivotIds.
        operationId: getPivot
        parameters:
          - in: path
            name: investigationPivotIdentifier
            description: Investigation ID and Pivot ID, separated by a comma
            required: true
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is pivot details
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetPivotDetailsResponse'
    pivot:
      post:
        description: Request to create pivot
        tags:
          - pivot
        summary: Create a pivot
        operationId: createPivot
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePivotRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is pivot created
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetPivotDetailsResponse'
    testParserArray:
      post:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Test the parser UI with an array as input
        tags:
          - testParser
        summary: test a parser
        operationId: testParserArray
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TestParserArrayRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: The parser results are returned
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/TestParserDetailsWrapper'
    breakLogs:
      post:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Separates event logs with a regex into a TestFileMessageGroup object
        tags:
          - testParser
        summary: break logs
        operationId: breakLogs

        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BreakLogsRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: The parser results are returned
            content:
              application/json:
                schema:
                  $ref: './test-file-management.yml#/components/schemas/TestFileMessageGroup'
    listSourcetypes:
      get:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Lists all sourcetypes for the current customer
        tags:
          - testParser
        summary: lists all sourcetypes for the current customer
        operationId: listSourcetypes
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: The parser results are returned
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetGenericDictResponse'
      post:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Update single sourcetype config
        tags:
          - testParser
        summary: Update a sourcetype
        operationId: updateSourcetype
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateSourcetypeRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is updated sourcetype config
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetGenericDictResponse'

    listSourcetypeNames:
      get:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Lists all sourcetype names for the current customer
        tags:
          - testParser
        summary: lists all sourcetype names for the current customer
        operationId: listSourcetypesNames
        responses:
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: The parser results are returned.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetGenericArrayResponse'

    unseparatedConfig:
      get:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Loads config for other configs, eg linktypes.conf or patterns.conf
        tags:
          - investigationConfig
        summary: loads config for other configs, eg linktypes.conf or patterns.conf
        operationId: loadUnseparatedConfig
        parameters:
          - name: path
            description: Path of the file you want to load
            required: true
            in: query
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: The parser results are returned
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetGenericDictResponse'
      post:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Saves config for other configs, eg linktypes.conf or patterns.conf
        tags:
          - investigationConfig
        summary: saves config for other configs, eg linktypes.conf or patterns.conf
        operationId: saveUnseparatedConfig
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SaveUnseparatedSourcetypesRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: The parser results are returned
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetGenericDictResponse'

    pivotResults:
      post:
        description: Fetch pivot result by POST
        tags:
          - event
        summary: Fetch pivot results
        operationId: getPivotResults
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetPivotResultsRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is the pivot results
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetPivotResultsResponse'

    pivotEvent:
      post:
        description: Request to create pivot event
        tags:
          - investigation
        summary: Create a pivot event
        operationId: createPivotEvent
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePivotEventRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, response is pivot event
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CreatePivotEventResponse'

    pivotComment:
      post:
        description: Request to create pivot comment
        tags:
          - investigation
        summary: Create a pivot comment
        operationId: createPivotComment
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePivotCommentRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, response is pivot comment
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CreatePivotCommentResponse'

    pivotCommentIdentifier:
      put:
        description: Request to update pivot comment
        tags:
          - investigation
        summary: Update a pivot comment
        operationId: updatePivotComment
        parameters:
          - in: path
            name: pivotCommentIdentifier
            description: Investigation and pivot IDs.
            required: true
            schema:
              type: string
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePivotCommentRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Operation succeeded, pivot comment updated
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CreatePivotCommentResponse'

    eventDetail:
      get:
        description: Request to get event detail
        tags:
          - event
        summary: Get event detail
        operationId: getEventDetail
        parameters:
          - in: query
            name: event_ids
            description: Event ids, comma-separated list of link, linkType, eventReference, and event time
            required: true
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Response is event detail (any events are subset only, start/end times may not match parent event)
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetEventDetailListResponse'

    logEntry:
      get:
        description: Request to get log entry
        tags:
          - event
        summary: Get log entry
        operationId: getLogEntry
        parameters:
          - in: query
            name: event_ids
            description: Event ids, comma-separated list of link, linkType, eventReference, and event time
            required: true
            schema:
              type: string
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is log entry
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetLogEntryListResponse'

    linkType:
      get:
        description: Request to get link types
        tags:
          - investigationConfig
        summary: Get link types (no parameters)
        operationId: getLinkType
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is set of link types
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetLinkTypeResponse'
    eventFactored:
      post:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Request to get event factored
        tags:
          - event
        summary: Get event factored
        operationId: getEventFactored
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RetrieveFactoredEventRequest'
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Success, response is retrieved factored event
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/RetrieveFactoredEventMapResponse'
    investigationReport:
      get:
        description: Request to get all investigation reports
        tags:
          - reports
        summary: Get all investigation reports
        operationId: getReports
        parameters:
          - in: query
            name: investigation_id
            description: Investigation Id
            required: true
            schema:
              type: string
        responses:
          200:
            description: Response is all investigation reports
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetReportsResponse'
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
      post:
        description: Request to create investigation report
        tags:
          - reports
        summary: Create an investigation report
        operationId: createReport
        parameters:
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateReportRequest'
        responses:
          200:
            description: Success, the report has been created
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/InvestigationReport'
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
      public:
        get:
          description: Request to fetch a public report
          tags:
            - reports
          summary: Fetch a public report
          operationId: getPublicReport
          parameters:
            - in: path
              name: id
              description: The download ID for the report, found in `download_url` on the createReport response
              required: true
              schema:
                type: string
          responses:
            200:
              description: Success, response fetched report
              content:
                application/pdf:
                  schema:
                    type: string
                    format: binary
                text/html:
                  schema:
                    type: string
                    format: binary
            default:
              description: Operation failed with an error
              content:
                application/json:
                  schema:
                    $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
      private:
        get:
          description: Request to fetch an authenticated report (requires user to be logged in)
          tags:
            - reports
          summary: Fetch a report
          operationId: getPrivateReport
          parameters:
            - in: path
              name: id
              description: The download ID for the report, found in `download_url` on the createReport response
              required: true
              schema:
                type: string
          responses:
            200:
              description: Success, response fetched report
              content:
                application/pdf:
                  schema:
                    type: string
                    format: binary
                text/html:
                  schema:
                    type: string
                    format: binary
            default:
              description: Operation failed with an error
              content:
                application/json:
                  schema:
                    $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
    serverTime:
      get:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Get Server Time
        tags:
          - investigationConfig
        summary: Get Server Time
        operationId: getServerTime
        responses:
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: reference URL response
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetServerTimeResponse'
    demoReset:
      delete:
        deprecated: true
        x-visibility: private
        description: >
          _This API is deprecated and should not be used._
          Reset the demo
        tags:
          - investigation
        summary: Reset the demo
        operationId: demo_reset
        responses:
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          204:
            description: Reset the demo
    eventEnrichmentLookupsDetails:
      get:
        description: |
          Retrieve details related to an event after performing search on lookup tables.
          The value being searched is the link type value of an event.
        tags:
          - investigation
        summary: Get details about events
        operationId: lookupEventEnrichmentDetails
        parameters:
          - in: query
            name: linkType
            description: |
              Link type of the event to decide lookup tables that will be searched.
              Link type can be of type ip address, email, username, etc.
            schema:
              type: string
            required: true
            example: ip
          - in: query
            name: linkValue
            description: Value of the link type that would be searched in lookup tables
            schema:
              type: string
            required: true
            example: 192.168.0.77
        responses:
          default:
            description: Operation failed with an error
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Return additional information about events
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/GetEventEnrichmentResponse'
    eventEnrichmentLookupsSummary:
      get:
        x-visibility: private
        description: |
          Retrieve summary related to an event after performing search on lookup tables.
          The value being searched is the link type value of an event.
          The widget name can be provided as a filter.
        tags:
          - investigation
        summary: Get summary about events.
        operationId: lookupEventEnrichmentSummary
        parameters:
          - in: query
            name: linkType
            description: |
              Link type of the event to decide lookup tables that will be searched.
              Link type can be of type ip address, email, username, etc.
            schema:
              type: string
            required: true
            example: ip
          - in: query
            name: linkValue
            description: The value of the link type that would be searched in lookup tables.
            schema:
              type: string
            required: true
            example: 192.168.0.77
          - in: query
            name: widgetName
            description: |
              Name of widget to get event enrichment summary of. If widgetName is not provided, event enrichment
              summary is returned for all widgets.
            schema:
              type: string
            required: false
            example: widget1
        responses:
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
          200:
            description: Return summary related to an event.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/EventEnrichmentSummaryResponse'

components:
  schemas:
    EventEnrichmentSummaryResponse:
      description: The summary related to an event after performing search on lookup tables.
      type: object
      required:
        - widgets
      properties:
        widgets:
          type: array
          description: List of event enrichment widget responses.
          items:
            $ref: '#/components/schemas/EventEnrichmentWidgetResponse'
    EventEnrichmentWidgetResponse:
      description: The summary related to an event and widget after performing search on lookup tables.
      type: object
      required:
        - refreshRate
        - presentation
        - data
        - name
      properties:
        refreshRate:
          type: integer
          format: int32
          description: >-
            The time (in seconds) the widget waits before getting the event enrichment summary. By default, the widgets
            don't auto refresh. When the refreshRate is 0, the widget won't auto-refresh.
          example: 1
          default: 0
        presentation:
          type: string
          description: The custom HTML that is used to present the widget in the UI.
          example: <div>{widgetData}</div>
        name:
          type: string
          description: The widget's name.
          example: widget1
        data:
          description: List of tables recieved after performing search on lookup tables.
          type: array
          items:
            $ref: '#/components/schemas/EventEnrichmentQueryResponse'
    GetEventEnrichmentResponse:
      description: The response, list of tables, after performing search on lookup tables
      type: object
      properties:
        data:
          description: List of tables recieved after performing search on lookup tables
          type: array
          items:
            $ref: '#/components/schemas/EventEnrichmentQueryResponse'

    EventEnrichmentQueryResponse:
      description: A query response containing table name and row from the table which matches the link type value being searched
      type: object
      properties:
        tableName:
          description: Table name
          type: string
          example: 'personalDetails'
        rowData:
          description: A row containing multiple columns retrieved after querying the lookup tables
          type: array
          items:
            $ref: '#/components/schemas/Column'

    Column:
      description: A column object which contains column name and the column value in a row
      type: object
      properties:
        columnName:
          description: Column name
          type: string
          example: 'Email'
        columnValue:
          description: Value of a column in a row which matches the link type value being searched
          type: string
          example: 'johndoe@sumologic.com'

    ErrorResponse:
      $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
    TestFileMessageGroup:
      $ref: './test-file-management.yml#/components/schemas/TestFileMessageGroup'

    UpdateInvestigationRequest:
      description: Request to update an investigation
      type: object
      properties:
        scratch_pad:
          description: Scratch pad field of the investigation
          type: string
        description:
          description: Description of the investigation
          type: string
        priority:
          description: Priority of the investigation
          type: string
        summary:
          description: Summary field of the investigation
          type: string
        assignee_id:
          description: User to whom the investigation is assigned, default value is the user creating this investigation
          type: integer
          format: int64
        status:
          description: Status of the investigation
          type: string
        status_fields:
          description: Status fields map for the investigation
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # tweaked to accommodate OpenAPI compilation
          # $ref: '#/components/schemas/StatusFields'

    CreateInvestigationRequest:
      description: Request to create investigation
      type: object
      properties:
        assignee_id:
          description: User to whom the investigation is assigned, default value is the user creating this investigation
          type: integer
          format: int64
          example: 123
        description:
          description: Description of the investigation
          type: string
          example: 'suspicious file activity'
        severity:
          description: Severity level of the investigation
          type: string
          example: 'Major'
        status:
          description: Status of the investigation
          type: string
          example: 'OPEN'
        status_fields:
          description: Status fields map for the investigation
          type: object
          additionalProperties:
            description: Single map entries
            type: object
            properties:
              code:
                description: Status numeric code
                type: integer
              text:
                description: Status text string
                type: string
          # tweaked to accommodate OpenAPI compilation
          # $ref: '#/components/schemas/StatusFields'
        base_properties:
          description: Base properties for create investigation request
          type: object
          additionalProperties:
            description: Single map entries
            type: object
            properties:
              # description: Map key and value
              fieldName:
                description: Map key (field name)
                type: string
                example: "attacker ip address"
              fieldData:
                description: Map value (comma-separated field value and type)
                type: string
                example: "1.1.1.1,IP Address"
          # tweaked to accommodate OpenAPI compilation
          # $ref: '#/components/schemas/RequestBaseProperties'
        priority:
          description: Priority level of the investigation (user-defined value)
          type: string
        type:
          description: Type of the investigation (user-defined value)
          type: string
    GetInvestigationListItem:
      description: Response investigation item
      type: object
      properties:
        id:
          description: Internal unique investigation ID
          type: string
        create_time:
          description: Time when investigation created
          type: integer
          format: int64
        update_time:
          description: Time when investigation last updated
          type: integer
          format: int64
        description:
          description: Description of the investigation
          type: string
        type:
          description: Type of the investigation (user-defined value)
          type: string
        severity:
          description: Severity of the investigation
          type: string
        status:
          description: Status of the investigation
          type: string
          example: 'OPEN'
        internal_status:
          description: Internal status field value of the investigation
          type: integer
          example: 123
        status_fields:
          description: Status fields map for the investigation
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # tweaked to accommodate OpenAPI compilation
          # $ref: '#/components/schemas/StatusFields'
        base_properties:
          description: Base properties of the investigation
          type: object
          additionalProperties:
            # workaround for OpenAPI compilation - can't just do type: object
            description: Single map entries
            $ref: '#/components/schemas/BasePropertiesItem'
          # $ref: '#/components/schemas/BaseProperties'
        creator:
          description: User who created the investigation
          $ref: '#/components/schemas/SanaUser'
        assignee:
          description: User assigned to the investigation
          $ref: '#/components/schemas/SanaUser'
        priority:
          description: Priority of the investigation
          type: string

    GetInvestigationDetailsResponse:
      description: Response investigation details
      type: object
      properties:
        status:
          description: Status of the investigation
          type: string
        severity:
          description: Severity of the investigation
          type: string
          example: 'OPEN'
        priority:
          description: Priority of the investigation
          type: string
        update_time:
          description: Time when investigation last updated
          type: integer
          format: int64
        internal_status:
          description: Internal status field value of the investigation
          type: integer
          format: int64
        status_fields:
          description: Status fields map for the investigation
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # tweaked to accommodate OpenAPI compilation
          # $ref: '#/components/schemas/StatusFields'
        base_properties:
          description: Base properties of the investigation
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # tweaked to accommodate OpenAPI compilation
          # $ref: '#/components/schemas/BaseProperties'
        creator:
          description: User who created the investigation
          $ref: '#/components/schemas/SanaUser'
        assignee:
          description: User assigned to the investigation
          $ref: '#/components/schemas/SanaUser'
        create_time:
          description: Time when investigation created
          type: integer
          format: int64
        type:
          description: Type of the investigation (user-defined value)
          type: string
          example: 'Failed Password Attempts'
        id:
          description: Internal unique investigation ID
          type: string
        description:
          description: Description of the investigation
          type: string
          example: 'One of a series of suspicious activities for this IP address'
        assignee_id:
          description: User to whom the investigation is assigned, default value is the user creating this investigation
          type: integer
          format: int64
        current_pivot:
          description: Current pivot identifier associated with this investigation
          type: string
        details:
          description: Detailed information of the investigation
          type: array
          items:
            $ref: '#/components/schemas/InvestigationDetails'
          # $ref: '#/components/schemas/Details'
        summary:
          description: Summary field of the investigation
          type: string
        scratch_pad:
          description: Scratch pad field of the investigation
          type: string

    CreateReportRequest:
      description: Request parameters for a report
      type: object
      properties:
        access:
          description: Either public or authenticated
          type: string
        content_type:
          description: Either text/html or application/json
          type: string
        investigation_id:
          description: Investigation ID
          type: string
        synchronous:
          description: Deprecated - synchronocity of job
          type: string
        customDateTimeFormat:
          $ref: '#/components/schemas/CustomDateTimeFormat'

    GetReportsResponse:
      description: The response for a report.
      type: object
      properties:
        results:
          description: The results.
          type: array
          items:
            $ref: '#/components/schemas/InvestigationReport'

    InvestigationReport:
      description: The report.
      type: object
      properties:
        access:
          description: Access permissions, either public or authenticated
          type: string
        content_type:
          description: Either text/html or application/pdf
          type: string
        create_time:
          description: When the report was created
          type: integer
          format: int64
        creator_id:
          description: The creator of the report
          type: integer
          format: int64
        download_url:
          description: The shareable link to the report
          type: string
        downloadId:
          description: The download ID for the report
          type: string
        investigation_id:
          description: The investigation ID
          type: string
        report_id:
          description: The report ID
          type: string
        status:
          description: The status of the report
          type: string

    StatusFields:
      description: StatusFields
      type: object
      additionalProperties:
        description: Single map entries
        type: object
        properties:
          code:
            description: code
            type: integer
          text:
            description: text
            type: string

    ListItemStatusFields:
      description: ListItemStatusFields
      type: object
      properties:
        inputs:
          description: inputs
          type: object
          additionalProperties:
            description: Single map entries
            $ref: '#/components/schemas/InputFields'
        errors:
          $ref: '#/components/schemas/Errors'
        warnings:
          description: warnings
          type: array
          items:
            type: string

    Errors:
      description: Errors
      type: object
      properties:
        action_errors:
          description: action_errors
          type: object
        #        addtionalProperties:
        #          type: array
        #          items:
        #            type: string
        input_errors:
          description: input_errors
          type: object
        #        addtionalProperties:
        #          type: array
        #          items:
        #            type: string
        status_errors:
          description: status_errors
          type: object
    #        type: array
    #        items:
    #          type: string

    InputFields:
      description: InputFields
      type: object
      properties:
        label:
          description: label
          type: string
        type:
          description: type
          type: string
        value:
          description: value
          type: object

    #  BaseProperties:
    #    type: object
    #    properties:
    #      base_event_reference:
    #        description: BaseEventReference
    #        type: string
    #      base_end_time:
    #        description: baseEndTime
    #        type: integer
    #        format: int64
    #      fields:
    #        type: object
    #      base_start_time:
    #        description: baseStartTime
    #        type: integer
    #        format: int64
    #      base_type:
    #        description: baseType
    #        type: string
    #      base_source_id:
    #        description: baseSourceId
    #        type: string

    RequestBaseProperties:
      description: Base properties for create investigation request
      type: object
      additionalProperties:
        description: Single map entries
        type: object
        properties:
          # description: Map key and value
          fieldName:
            description: Map key (field name)
            type: string
            example: "attacker ip address"
          fieldData:
            description: Map value (comma-separated field value and type)
            type: string
            example: "1.1.1.1,IP Address"

    BaseProperties:
      description: BaseProperties
      type: object
      additionalProperties:
        description: Single map entries
        # workaround for OpenAPI bug - can't just do type: object
        $ref: '#/components/schemas/BasePropertiesItem'

    BasePropertiesItem:
      type: object

    InvestigationDropReason:
      description: InvestigationDropReason
      type: object
      properties:
        description: properties
        type:
          description: type
          type: string
        value:
          description: value
          type: string
        label:
          description: label
          type: string

    SanaUser:
      description: User definition
      type: object
      properties:
        name:
          description: Name of the user
          type: string
        roles:
          description: List of roleIds associated with the user
          type: array
          items:
            type: string
          example:
            ['Analyst']
        is_active:
          description: Whether the user is active
          type: boolean
        email:
          description: Email of the user
          type: string
          format: email
        id:
          description: ID of the user
          type: integer
          format: int64

    Details:
      description: Details
      type: array
      items:
        $ref: '#/components/schemas/InvestigationDetails'

    InvestigationDetails:
      description: InvestigationDetails
      type: object
      properties:
        investigation_id:
          description: ID of the investigation
          type: string
        create_time:
          description: Creation time of the pivot
          type: integer
          format: int64
        pivot_id:
          description: Pivot ID
          type: string
        detail_id:
          description: Detail ID for the pivot
          type: string
        type:
          description: Pivot type
          type: string
          example:
            "status"
        contents:
          description: Pivot contents
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # $ref: '#/components/schemas/GetGenericDictResponse'

    Contents:
      description: Contents
      type: object
      properties:
        status:
          description: status
          type: string
        comment:
          description: Body of the comment
          type: string
        internal_status:
          description: internal_status
          type: integer
          format: int64
        status_fields:
          description: Status fields map for the investigation
          $ref: '#/components/schemas/StatusFields'
        user:
          description: User who created the request
          $ref: '#/components/schemas/SanaUser'

    UpdateBaseProperties:
      description: UpdateBaseProperties
      type: object
      properties:
        base_event_reference:
          description: BaseEventReference
          type: array
          items:
            type: string
        base_end_time:
          description: baseEndTime
          type: integer
        fields:
          $ref: '#/components/schemas/UpdateFields'
        base_start_time:
          description: baseStartTime
          type: integer
        base_type:
          description: baseType
          type: string
        base_source_id:
          description: baseSourceId
          type: string

    UpdateFields:
      description: UpdateFields
      type: object
      properties:
        include_links:
          description: include_links
          type: string
        exclude_links:
          description: exclude_links
          type: string
    BreakLogsRequest:
      description: BreakLogsRequest
      type: object
      required:
        - logs
        - breakingRegex
      properties:
        logs:
          description: The log data to break.
          type: string
        breakingRegex:
          description: regex to break the logs
          type: string

    TestParserRequest:
      description: TestParserRequest
      type: object
      properties:
        logs:
          description: The log data tested.
          type: string
        sourcetype:
          description: The sourcetype tested.
          type: string
        config:
          description: Additional config for the parser, either in string form or in the form of a stringified json map of config paths to their respective overriding configurations.
          type: string
        parserPath:
          description: Path to the file the parser is stored in.
          type: string
        breakingRegex:
          description: Regex to break the log files up by.
          type: string
        configOnly:
          description: Use additional config only.
          type: boolean
          default: false
    TestParserArrayRequest:
      description: TestParserArrayRequest
      type: object
      properties:
        logs:
          $ref: './test-file-management.yml#/components/schemas/TestFileMessageGroup'
        sourcetype:
          description: The sourcetype tested.
          type: string
        config:
          description: Additional config for the parser, either in string form or in the form of a stringified json map of config paths to their respective overriding configurations.
          type: string
        parserPath:
          description: Path to the file the parser is stored in.
          type: string
        configOnly:
          description: Use additional config only.
          type: boolean
          default: false
    TestParserV2Request:
      description: Version two of the test parser endpoint that takes a parser resource as input.
      type: object
      required:
        - events
        - parentFolderId
        - parser
      properties:
        events:
          $ref: './test-file-management.yml#/components/schemas/TestFileMessageGroup'
        parentFolderId:
          description: This is the directory this parser would be inserted in.
          type: string
        parser:
          $ref: './parsers-content-library-management.yml#/components/schemas/ParsersLibraryParser'
    UpdateSourcetypeRequest:
      description: UpdateSourcetypeRequest
      type: object
      properties:
        sourcetype:
          description: the sourcetype to update.
          type: string
        configName:
          description: The name of the updated config file.
          type: string
        config:
          description: The config to update to that file.
          type: string
    SaveUnseparatedSourcetypesRequest:
      description: SaveUnseparatedSourcetypesRequest
      type: object
      properties:
        path:
          description: The path of the file saved.
          type: string
        config:
          description: The config to save.
          type: string

    ListSourcetypesRequest:
      description: ListSourcetypesRequest
      type: object
      properties:
        config:
          description: Additional config for the parser.
          type: string

    CreatePivotRequest:
      description: Parameters to create pivot request
      type: object
      properties:
        inclusions:
          description: Set of comma-separated {link value, link type} tuples, separated by commas
          type: string
        exclusions:
          description: Set of comma-separated {link value, link type} tuples, separated by commas
          type: string
        investigation_id:
          description: Investigation id
          type: string
        chain:
          description: Whether to chain events
          type: boolean
        start_time:
          description: Lower time bound for pivot calculation as epoch time value
          type: integer
          format: int64
        end_time:
          description: Upper time bound for pivot calculation as epoch time value
          type: integer
          format: int64
        previous_pivot_id:
          description: Previous pivot id, if any
          type: string
        comment:
          description: Initial comment value
          type: string
        view:
          description: Pivot view (default aggregate)
          type: string

    GetPivotDetailsResponse:
      description: GetPivotDetailsResponse
      type: object
      properties:
        id:
          description: Pivot id
          type: string
        investigation_id:
          description: Investigation id
          type: string
        start_time_text:
          description: Lower time bound for pivot calculation as text
          type: string
        end_time_text:
          description: Upper time bound for pivot calculation as text
          type: string
        start_time:
          description: Lower time bound for pivot calculation as epoch time value
          type: integer
          format: int64
        end_time:
          description: Upper time bound for pivot calculation as epoch time value
          type: integer
          format: int64
        inclusions:
          description: Set of comma-separated {link value, link type} tuples, separated by commas
          type: string
        exclusions:
          description: Set of comma-separated {link value, link type} tuples, separated by commas
          type: string
        previous_pivot_id:
          description: Previous pivot id, if any
          type: string
        comment:
          description: Comment field value
          type: string
        chain:
          description: Whether chained events
          type: boolean
        view:
          description: Pivot view (default aggregate)
          type: string
        details:
          description: Detailed information of the investigation
          type: array
          items:
            $ref: '#/components/schemas/InvestigationDetails'
          # $ref: '#/components/schemas/Details'
        user:
          description: User who created the investigation
          $ref: '#/components/schemas/SanaUser'

    GetPivotResultsRequest:
      description: Parameters for request to get pivot results
      type: object
      properties:
        investigation_id:
          description: Investigation id
          type: string
        pivot_id:
          description: Pivot id
          type: string
        limit:
          description: Size bound on result set
          type: integer
        offset:
          description: Do not use (internal use only)
          type: string
        view:
          description: >
            Pivot results view.  Range 0-3, supported values are:
              0: Aggregate
              1: Summary
              2: Detail
              3: Raw
          type: integer

    GetPivotResultsResponse:
      description: GetPivotResultsResponse
      type: object
      properties:
        hub_links:
          description: Collection of hub links
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # $ref: '#/components/schemas/GetGenericDictResponse'
        query_stats:
          description: Collection of query statistics
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # $ref: '#/components/schemas/GetGenericDictResponse'
        results:
          description: Collection of pivot results
          type: object
          additionalProperties:
            description: Single map entries
            type: array
            items:
              $ref: '#/components/schemas/RetrieveFactoredEventResponse'
        next:
          description: Information for subsequent query
          type: object

    CreatePivotCommentRequest:
      description: Parameters for create pivot comment request
      type: object
      properties:
        investigation_id:
          description: Investigation id
          type: string
        pivot_id:
          description: Pivot id
          type: string
        detail_id:
          description: Detail id
          type: string
        comment:
          description: Body of the comment
          type: string


    UpdatePivotCommentRequestParams:
      description: UpdatePivotCommentRequestParams
      type: string

    CreatePivotCommentResponse:
      description: CreatePivotCommentResponse
      type: object
      properties:
        investigation_id:
          description: ID of the investigation
          type: string
        pivot_id:
          description: ID of the pivot in the investigation
          type: string
        create_time:
          description: Time of creation
          type: integer
          format: int64
        detail_id:
          description: ID of the details for the pivot
          type: string
        comment:
          description: Body of the comment
          type: string

    ResultRecursiveLinks:
      description: ResultRecursiveLinks
      type: object
      properties:
        ip1:
          $ref: '#/components/schemas/ResultLinks'
        ip2:
          $ref: '#/components/schemas/ResultLinks'
        ip3:
          $ref: '#/components/schemas/ResultLinks'

    ResultLinks:
      description: ResultLinks
      type: object
      properties:
        linkType:
          description: linkType
          type: string
        resultCount:
          description: resultCount
          type: integer
        errors:
          description: errors
          type: array
          items:
            type: string
        uniqueResultCount:
          description: uniqueResultCount
          type: integer
        queryCount:
          description: queryCount
          type: integer

    ResultPrimaryLinks:
      description: ResultPrimaryLinks
      type: object
      properties:
        ip1:
          $ref: '#/components/schemas/ResultLinks'

    Fields:
      description: Fields
      type: object
      properties:
        field_name:
          description: field_name
          type: string
        field_value:
          description: field_value
          type: string
        field_type:
          description: field_type
          type: string

    GetParseTimeResponse:
      description: GetParseTimeResponse
      type: object
      properties:
        time_utc:
          description: time_utc
          type: string
        time_local:
          description: time_local
          type: string
        time:
          description: time
          type: string
        timestamp:
          description: timestamp
          type: integer
        timezone:
          description: timezone
          type: string

    CreatePivotEventRequest:
      description: CreatePivotEventRequest
      type: object
      properties:
        investigation_id:
          description: ID of the investigation
          type: string
        pivot_id:
          description: ID of the pivot in the investigation
          type: string
        event_list:
          description: Collection of events
          type: array
          items:
            type: object
            additionalProperties:
              description: Single map entries
              type: object
          # $ref: '#/components/schemas/EventListItemRequest'
        comment:
          description: Body of the comment
          type: string

    EventListItemRequest:
      description: EventListItemRequest
      type: array
      items:
        type: object
        additionalProperties:
          description: Single map entries
          type: object
    TestParserDetails:
      description: Details about a specific event.
      type: object
      properties:
        fields:
          description: The fields from the event.
          type: object
          additionalProperties:
            description: A field in the factor in index 0 and the type of the field in index 1 in an array.
            type: array
            items:
              type: object
        factors:
          description: The factors from the event.
          type: object
          additionalProperties:
            description: An array of all factors associated with the specified factor type.
            type: array
            items:
              description: A dictionary of fields in the factor.
              type: object
              additionalProperties:
                description: A field in the factor in index 0 and the type of the field in index 1 in an array.
                type: array
                items:
                  type: string
        start_time:
          description: The start time of the event.
          type: string
        parsed:
          description: Whether this event was successfully parsed or not.
          type: boolean
        drop:
          description: Whether this event was dropped from the database or not.
          type: boolean
        logEntry:
          description: The log entry associated with this event.
          type: string
        isBurndown:
          description: Whether a factor in this event is added as an investigation.
          type: boolean
          example: true, false
        errors:
          description: The errors associated with this event.
          type: array
          items:
            type: string
        hubs:
          description: Dictionary of hubs associated with the event.
          type: object
          additionalProperties:
            description: An array of all hubs associated with a specific link type.
            type: object
            additionalProperties:
              description: A description of the hub, currently unused by Investigation Workflow.
              type: string
        nonModelFields:
          description: The fields from the original event before the model was applied.
          type: object
          additionalProperties:
            description: A field in the fields in index 0 and the type of the field in index 1 in an array.
            type: array
            items:
              type: object
        transforms:
          description: The transforms associated with this event.
          type: array
          items:
            type: string

    TestParserDetailsSet:
      description: Results of a parser for testing.
      type: object
      properties:
        Unparsed Events:
          type: array
          description: list of unparsed events.
          items:
            $ref: '#/components/schemas/TestParserDetails'
        Events With Errors:
          type: array
          description: list of events with errors.
          items:
            $ref: '#/components/schemas/TestParserDetails'
        Dropped Events:
          type: array
          description: list of dropped events.
          items:
            $ref: '#/components/schemas/TestParserDetails'
        Parsed Events:
          type: array
          description: list of parsed events.
          items:
            $ref: '#/components/schemas/TestParserDetails'
    TestParserDetailsWrapper:
      description: Wrapper of the properties of TestParserDetailsSet.
      type: object
      properties:
        results:
          $ref: "#/components/schemas/TestParserDetailsSet"
        configurationCompilationErrors:
          type: array
          description: List of error messages associated with compiling the configuration, if any.
          items:
            type: string
            example: "/Parsers/Sumo/Example - Warning: Stanza parser:Example contains duplicate key TRANSFORM"
    ParserContentsItemRequest:
      description: ParserContentsItemRequest
      type: array
      items:
        type: object
        additionalProperties:
          description: Single map entries
          type: object
    #        properties:
    #          factor_type:
    #            type: string
    #          count:
    #            type: integer
    #            format: int32
    #          start_time:
    #            type: integer
    #            format: int64
    #          end_time:
    #            type: integer
    #            format: int64
    #          link_key_type:
    #            type: string
    #          link_key:
    #            type: string
    #          event_id:
    #            type: string
    #          event_view:
    #            type: integer
    #            format: int32

    Event:
      description: Event
      type: object
      properties:
        count:
          description: count
          type: integer
          format: int32
        factorID:
          description: factorID
          type: string
        via:
          description: via
          type: array
          items:
            type: string
        logEntry:
          description: logEntry
          type: string
        links:
          description: links
          type: array
          items:
            type: array
            items:
              type: string
        fields:
          $ref: '#/components/schemas/GetGenericDictResponse'
        startTimestamp:
          description: startTimestamp
          type: integer
          format: int64
        isClip:
          description: isClip
          type: boolean
        comments:
          description: comments
          type: string
        logType:
          description: logType
          type: array
          items:
            type: string
        startTime:
          description: startTime
          type: integer
        eventReferences:
          required: false
          type: array
          items:
            type: string
        endTime:
          description: endTime
          type: integer
        sourceDesc:
          description: sourceDesc
          type: string
        endTimestamp:
          description: startTimestamp
          type: integer
          format: int64

    CreatePivotEventResponse:
      description: CreatePivotEventResponse
      type: object
      properties:
        investigation_id:
          description: ID of the investigation
          type: string
        pivot_id:
          description: ID of the pivot
          type: string
        create_time:
          description: Creation time
          type: integer
          format: int64
        detail_id:
          description: ID of the investigation detail
          type: string
        contents:
          description: Contents of the pivot event
          type: object
        #        $ref: '#/definitions/EventContents'
        type:
          description: type
          type: string

    EventContents:
      description: EventContents
      type: object
      properties:
        comment:
          description: Event list comment
          type: string
        event_list:
          description: List of events
          type: array
          items:
            $ref: '#/components/schemas/EventListItemResponse'
        user:
          description: User who made the request
          $ref: '#/components/schemas/SanaUser'
        is_active:
          description: Whether the event contents are active
          type: boolean

    EventListItemResponse:
      description: EventListItemResponse
      type: object
      properties:
        factor_type:
          description: factor_type
          type: string
        count:
          description: count
          type: integer
          format: int32
        start_time:
          description: start_time
          type: integer
          format: int64
        end_time:
          description: end_time
          type: integer
          format: int64
        link_key_type:
          description: link_key_type
          type: string
        link_key:
          description: link_key
          type: string
        event_id:
          description: event_id
          type: string
        event_view:
          description: event_view
          type: integer
          format: int32
        log_type:
          description: log_type
          type: string
        event:
          $ref: '#/components/schemas/Event'

    GetStatusResponse:
      description: GetStatusResponse
      type: array
      items:
        $ref: '#/components/schemas/StatusResponse'

    StatusResponse:
      description: StatusResponse
      type: object
      properties:
        errors:
          description: Collections of errors
          $ref: '#/components/schemas/StatusError'
        following_statuses:
          description: Possible subsequent status values
          type: array
          items:
            type: string
        has_errors:
          description: Whether error(s) occurred
          type: boolean
        has_warnings:
          description: Whether warning(s) occurred
          type: boolean
        inputs:
          description: Collection of input elements
          type: object
          additionalProperties:
            description: Single map entries
            type: object
          # $ref: '#/components/schemas/GetGenericDictResponse'
        internal_status:
          description: Internal status value
          type: integer
          format: int32
        name:
          description: Name of the status field
          type: string
        warnings:
          description: Collection of warnings
          type: array
          items:
            type: string

    StatusError:
      description: Collections of errors
      type: object
      properties:
        action_errors:
          description: Action errors
          type: object
          additionalProperties:
            description: Collection of single map entries
            type: array
            items:
              type: string
        input_errors:
          description: Input errors
          type: object
          additionalProperties:
            description: Collection of single map entries
            type: array
            items:
              type: string
        status_errors:
          description: Status errors
          type: array
          items:
            type: string

    GetInvestigationConfigResponse:
      description: Investigation config responsee
      type: object
      properties:
        description:
          description: Description (path) information
          type: string
        status_fields:
          description: Status fields map for the investigation
          type: object
        priority:
          description: Priority (default) informatio
          type: string
        priority_values:
          description: Priority values information
          type: array
          items:
            type: string
        summary_length:
          description: Summary length information
          type: string
        type:
          description: Investigation type (default) information
          type: string
        retention:
          description: Retention information (default, in seconds)
          type: string

    GetInvestigationListNext:
      description: GetInvestigationListNext
      type: object
      properties:
        limit:
          description: limit
          type: integer
          format: int32
        offset:
          description: offset
          type: string

    GetInvestigationListResponse:
      description: GetInvestigationListResponse
      type: object
      properties:
        results:
          description: Investigation results
          type: array
          items:
            $ref: '#/components/schemas/GetInvestigationListItem'
        next:
          description: Data for subsequent query
          type: object
    GetEventDetailListResponse:
      # $ref: '#/definitions/GetInvestigationListItem'
      type: object
      properties:
        hub_links:
          description: Collection of hub links
          type: object
          additionalProperties:
            description: Single map entries
            type: object
        results:
          description: Event details results
          type: array
          items:
            $ref: '#/components/schemas/GetEventDetailResponse'
        next:
          description: Information for subsequent query
          type: string
    GetEventDetailResponse:
      description: Event detail information
      type: object
      properties:
        id:
          description: ID of the investigation
          type: string
        start_time:
          description: Start time of the event(s)
          type: string
        end_time:
          description: End time of the event(s)
          type: string
        source_id:
          description: ID of the source
          type: string
        log_type:
          description: Array of log types
          type: array
          items:
            type: string
        via:
          description: Via reference for the event
          type: array
          items:
            type: string
        fields:
          description: Fields of the event detail
          type: object
          additionalProperties:
            description: Single map entries
            type: object
    GetLogEntryListResponse:
      # $ref: '#/definitions/GetInvestigationListItem'
      type: object
      properties:
        hub_links:
          description: Collection of hub links
          type: object
          additionalProperties:
            description: Single map entries
            type: object
        results:
          description: List of log entries
          type: array
          items:
            $ref: '#/components/schemas/GetLogEntryResponse'
        next:
          description: next
          type: string
    RetrieveFactoredEventMapResponse:
      description: RetrieveFactoredEventMapResponse
      type: object
      properties:
        hub_links:
          description: GetGenericDictResponse
          type: object
          additionalProperties:
            description: Collection of single map entries
            type: object
        results:
          description: results
          type: object
          additionalProperties:
            description: Collection of single map entries
            type: array
            items:
              $ref: '#/components/schemas/RetrieveFactoredEventResponse'
        has_more:
          description: has_more
          type: boolean
        next:
          description: paging_token
          type: object
        query_stats:
          description: see QueryStatistics for examples
          type: object
          additionalProperties:
            description: Collection of single map entries
            type: object
    GetLogEntryResponse:
      description: GetLogEntryResponse
      type: object
      properties:
        id:
          description: ID of the log entry
          type: string
        start_time:
          description: Start time of the log entry
          type: string
        end_time:
          description: End time of the log entry
          type: string
        source_id:
          description: Source ID
          type: string
        log_type:
          description: List of log types
          type: array
          items:
            type: string
        via:
          description: Via reference for the log entry
          type: array
          items:
            type: string
        log_entry:
          description: Raw log entry
          type: string

    GetGenericArrayResponse:
      description: GetGenericArrayResponse
      type: array
      items:
        type: object

    GetGenericDictResponse:
      description: GetGenericDictResponse
      type: object
      additionalProperties:
        # workaround for OpenAPI bug - can't just do type: object
        description: Single map entries
        $ref: '#/components/schemas/GetGenericDictItem'

    GetGenericDictItem:
      type: object

    GetLinkTypeResponse:
      description: GetLinkTypeResponse
      type: object
      properties:
        results:
          description: Link type results
          type: array
          items:
            description: Link type results
            $ref: '#/components/schemas/LinkTypeResults'
    LinkTypeResults:
      description: LinkTypeResults
      type: object
      properties:
        name:
          description: Link name
          type: string
        verbose_name:
          description: Link descriptive name
          type: string
        db_type:
          description: Link type
          type: string
        regex:
          description: Regular expression
          type: string
    GetServerTimeResponse:
      description: GetServerTimeResponse
      type: object
      properties:
        time_utc:
          description: time_utc
          type: string
        time_local:
          description: time_local
          type: string
        timestamp:
          description: timestamp
          type: integer
          format: int64
        timezone:
          description: timezone
          type: string
    RetrieveFactoredEventRequest:
      description: RetrieveFactoredEventRequest
      type: object
      properties:
        aggregate:
          description: aggregate
          type: boolean
        start_time_text:
          description: start_time_text
          type: string
        end_time_text:
          description: end_time_text
          type: string
        inclusions:
          description: inclusions
          type: array
          items:
            type: string
        offset:
          description: offset
          type: string
        chain:
          description: chain
          type: boolean
        limit:
          description: limit
          type: integer
          format: int32
    RetrieveFactoredEventResponse:
      description: RetrieveFactoredEventResponse
      type: object
      properties:
        id:
          description: id
          type: string
        start_time:
          description: start_time
          type: string
        end_time:
          description: end_time
          type: string
        source_id:
          description: source_id
          type: string
        log_type:
          description: log_type
          type: array
          items:
            type: string
        via:
          description: via
          type: array
          items:
            type: array
            items:
              type: string
        fields:
          description: GetGenericDictResponse
          type: object
          additionalProperties:
            description: Single map entries
            type: object
        count:
          description: count
          type: integer
        event_references:
          description: event_references
          type: array
          items:
            type: object
        log_entry:
          description: log_entry
          type: string
    CustomDateTimeFormat:
      description: Use it to customize date and time format.
      type: object
      required:
        - dateFormat
      properties:
        dateFormat:
          description: >-
            Define custom format to represent date and time. Custom date and time format can be described using symbols
            defined in documentation of [DateTimeFormatter](https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html)
            class. For example, using "yyyy-MM-dd'T'HH:mm:ssxxx" (ISO 8601 format) will format date at "2019-11-17T19:53:23+08:00".
          type: string
          example: "yyyy-MM-dd'T'HH:mm"
          default: "yyyy-MM-dd'T'HH:mmxxx"
        timezone:
          description: >
            Timezone for custom date. `timezone` should be specified in the
            [IANA Time Zone Database](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List) format.
          type: string
          example: 'America/Los_Angeles'
          default: 'Etc/UTC'