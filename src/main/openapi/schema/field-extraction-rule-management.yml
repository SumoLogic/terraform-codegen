paths:
  #/v2/extractionRules
  v2:
    fieldExtractionRules:
      get:
        summary: Get a list of field extraction rules.
        description: >-
          Get a list of all field extraction rules. The response is paginated with a default limit of 100 field extraction
          rules per page.
        operationId: listFieldExtractionRules
        tags:
          - fieldExtractionRuleManagement
        parameters:
          - name: limit
            description: >-
              Limit the number of field extraction rules returned in the response. The number of field extraction rules returned
              may be less than the `limit`.
            required: false
            in: query
            schema:
              type: integer
              format: int32
              default: 100
              maximum: 1000
              minimum: 1
          - name: token
            description: >-
              Continuation token to get the next page of results. A page object with the next continuation token is returned
              in the response body. Subsequent GET requests should specify the continuation token to get the next page of
              results.
            required: false
            in: query
            schema:
              type: string
        responses:
          200:
            description: A paginated list of field extraction rules.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ListFieldExtractionRulesResponse'
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
      post:
        x-tf-create: true
        x-tf-resourceName: FieldExtractionRule
        x-tf-path: v1/extractionRules
        summary: Create a new field extraction rule.
        description: Create a new field extraction rule.
        operationId: createFieldExtractionRule
        tags:
          - fieldExtractionRuleManagement
        parameters: []
        requestBody:
          description: Information about the new field extraction rule.
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FieldExtractionRuleDefinition'
        responses:
          200:
            description: The field extraction rule has been created.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/FieldExtractionRule'
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
    # /v2/extractionRules/{id} endpoint
    fieldExtractionRuleId:
      get:
        x-tf-read: true
        x-tf-resourceName: FieldExtractionRule
        x-tf-path: v1/extractionRules/%s
        summary: Get a field extraction rule.
        description: Get a field extraction rule with the given identifier.
        operationId: getFieldExtractionRule
        tags:
          - fieldExtractionRuleManagement
        parameters:
          - name: id
            description: Identifier of field extraction rule to return.
            required: true
            in: path
            schema:
              type: string
        responses:
          200:
            description: Field extraction rule object that was requested.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/FieldExtractionRule'
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
      put:
        x-tf-update: true
        x-tf-resourceName: FieldExtractionRule
        x-tf-path: v1/extractionRules/%s
        summary: Update a field extraction rule.
        description: >-
          Update an existing field extraction rule. All properties specified in the request are replaced. Missing properties
          are set to their default values.
        operationId: updateFieldExtractionRule
        tags:
          - fieldExtractionRuleManagement
        parameters:
          - name: id
            description: Identifier of the field extraction rule to update.
            required: true
            in: path
            schema:
              type: string
        requestBody:
          description: Information to update about the field extraction rule.
          required: true
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/FieldExtractionRuleDefinition'
        responses:
          200:
            description: The field extraction rule was successfully modified.
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/FieldExtractionRule'
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'
      delete:
        x-tf-delete: true
        x-tf-resourceName: FieldExtractionRule
        x-tf-path: v1/extractionRules/%s
        summary: Delete a field extraction rule.
        description: Delete a field extraction rule with the given identifier.
        operationId: deleteFieldExtractionRule
        tags:
          - fieldExtractionRuleManagement
        parameters:
          - name: id
            description: Identifier of the field extraction rule to delete.
            required: true
            in: path
            schema:
              type: string
        responses:
          204:
            description: Field extraction rule was deleted successfully.
          default:
            description: Operation failed with an error.
            content:
              application/json:
                schema:
                  $ref: './generic-responses.yml#/components/schemas/ErrorResponse'

components:
  schemas:
    FieldExtractionRuleDefinition:
      type: object
      required:
        - name
        - appliedAt
        - scope
        - parseExpression
        - enabled
      properties:
        name:
          description: Name of the field extraction rule. Use a name that makes it easy to identify the rule.
          type: string
          example: 'FieldExtractionRule123'
          minLength: 1
          maxLength: 256
        appliedAt:
          description: >-
            Determines when fields will be extracted. Supported values are:
              1. `Ingest` The fields will be extracted and stored when data is received by Sumo Logic.
              2. `Runtime` The fields will be extracted during the execution of a search query
          type: string
          example: 'Ingest'
          minLength: 1
          maxLength: 100
        scope:
          description: >-
            Scope of the field extraction rule. This could be a sourceCategory, sourceHost, or any other metadata that
            describes the data you want to extract from. Think of the Scope as the first portion of an ad hoc search,
            before the first pipe ( | ). You'll use the Scope to run a search against the rule.
          type: string
          example: '_sourceHost=127.0.0.1'
          minLength: 0
          maxLength: 2048
        parseExpression:
          description: >-
            Describes the fields to be parsed.
          type: string
          example: 'parse "message count = *," as msg_count'
          maxLength: 16384
        enabled:
          description: Is the field extraction rule enabled.
          type: boolean
          default: true

    FieldExtractionRule:
      x-tf-resource: true
      x-tf-generated-properties: id,name,scope,parseExpression,enabled
      type: object
      allOf:
        - $ref: '#/components/schemas/FieldExtractionRuleDefinition'
        - $ref: './generic-models.yml#/components/schemas/MetadataModel'
        - required:
            - id
          properties:
            id:
              description: Unique identifier for the field extraction rule.
              type: string
            fieldNames:
              x-tf-resource-readonly: true
              description: List of extracted fields from "parseExpression".
              type: array
              items:
                type: string

    ListFieldExtractionRulesResponse:
      type: object
      required:
        - data
      properties:
        data:
          description: List of field extraction rules.
          type: array
          items:
            $ref: '#/components/schemas/FieldExtractionRule'
        next:
          description: Next continuation token.
          type: string